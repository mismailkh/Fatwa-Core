using FATWA_DOMAIN.Models.ViewModel.Shared;
using Microsoft.AspNetCore.Components;
using PdfSharp.Drawing;
using PdfSharp.Pdf;
using SelectPdf;
using Syncfusion.Blazor.PdfViewerServer;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Text;
using Telerik.Blazor.Components;
using TheArtOfDev.HtmlRenderer.PdfSharp;

namespace FATWA_WEB.Pages.Shared
{
    //<History Author = 'Hassan Abbas' Date='2022-10-30' Version="1.0" Branch="master">Preview Draft in a popup</History>
    public partial class PreviewDraft : ComponentBase
    {
        [Parameter]
        public string Content { get; set; }
        public TelerikPdfViewer PdfViewerRef { get; set; }
        public byte[] FileData { get; set; }
        public bool DisplayDocumentViewer { get; set; }
        public MarkupString html { get; set; }
        public SfPdfViewerServer pdfViewer;
        public string DocumentPath { get; set; } = string.Empty;
        #region Component Load
        protected override async Task OnInitializedAsync()
        {
            try
            {
                spinnerService.Show();
                await PopulatePdfFromHtml();
                spinnerService.Hide();
            }
            catch (Exception ex)
            {

            }
        }

        #endregion


        //<History Author = 'Hassan Abbas' Date='2022-09-30' Version="1.0" Branch="master">Populate Case Template Parameters</History>
        protected async Task PopulatePdfFromHtml()
        {
            try
            {
                html = new MarkupString("<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span dir=\"LTR\" style='font-size:13px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span dir=\"LTR\" style='font-size:13px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span dir=\"LTR\" style='font-size:13px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:19px;font-family:\"Calibri\",sans-serif;'>الكويت في :&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:right;'><strong><span style='font-size:19px;font-family:\"Calibri\",sans-serif;'>مرجع &nbsp;رقم :</span></strong><strong><span style='font-size:19px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<h2 dir=\"RTL\" style='margin:0cm;text-align:center;font-size:19px;font-family:\"Simplified Arabic\",serif;'><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></h2>\r\n<div style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:#F3F3F3;'>\r\n    <p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;background:#F3F3F3;border:none;padding:0cm;'><strong><span style='font-size:28px;font-family:\"Calibri\",sans-serif;color:black;'>إخطار بإقامة دعوى&nbsp;</span></strong></p>\r\n</div>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-size:11px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-bottom:12.0pt;text-align:justify;'><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-bottom:12.0pt;text-align:justify;'><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>حضرة</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>الفاضل/</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>المحتـرم</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-bottom:12.0pt;text-align:justify;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>تحية طيبة وبعد ،،،</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>مُرفق طيه صورة من صحيفة الدعوى رقم&nbsp;</span></strong><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;المقامة</span></strong><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;:&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-top:12.0pt;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>مــــن :&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-top:12.0pt;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>ضــــد:&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-top:12.0pt;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>الدائرة الإدارية /&nbsp;</span></strong><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;والمحدد لنظرها جلسة:</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:right;text-indent:14.8pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>يرجى العلم والإحاطة واتخاذ ما يلزم بشأن تمثيل &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;في هذه الدعوى وإبداء ما يلزم من دفاع فيها بمعرفة الإدارة القانونية لديكم.</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>مـــع أطيـــب التمنيـــات ،،،</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin: 0cm;font-size:16px;font-family: \"Times New Roman\", serif;text-align: right;'><strong><span style='font-size:27px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp;رئيس قطاع قضايا الإداري الكلي</span></strong><strong><span style='font-size:27px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:18px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:18px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:18px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:11px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>العضو المختص :&nbsp;</span></strong><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>المرفقات &nbsp;: صورة صحيفة الدعوى</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></strong></p>");
                var rawHtml = "<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span dir=\"LTR\" style='font-size:13px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span dir=\"LTR\" style='font-size:13px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span dir=\"LTR\" style='font-size:13px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:19px;font-family:\"Calibri\",sans-serif;'>الكويت في :&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:right;'><strong><span style='font-size:19px;font-family:\"Calibri\",sans-serif;'>مرجع &nbsp;رقم :</span></strong><strong><span style='font-size:19px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<h2 dir=\"RTL\" style='margin:0cm;text-align:center;font-size:19px;font-family:\"Simplified Arabic\",serif;'><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></h2>\r\n<div style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:#F3F3F3;'>\r\n    <p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;background:#F3F3F3;border:none;padding:0cm;'><strong><span style='font-size:28px;font-family:\"Calibri\",sans-serif;color:black;'>إخطار بإقامة دعوى&nbsp;</span></strong></p>\r\n</div>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-size:11px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-bottom:12.0pt;text-align:justify;'><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-bottom:12.0pt;text-align:justify;'><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>حضرة</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>الفاضل/</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></strong><strong><span style='font-size:24px;font-family:\"Calibri\",sans-serif;'>المحتـرم</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-bottom:12.0pt;text-align:justify;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>تحية طيبة وبعد ،،،</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>مُرفق طيه صورة من صحيفة الدعوى رقم&nbsp;</span></strong><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;المقامة</span></strong><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;:&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-top:12.0pt;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>مــــن :&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-top:12.0pt;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>ضــــد:&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;margin-top:12.0pt;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>الدائرة الإدارية /&nbsp;</span></strong><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;والمحدد لنظرها جلسة:</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;text-indent:8.15pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:right;text-indent:14.8pt;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>يرجى العلم والإحاطة واتخاذ ما يلزم بشأن تمثيل &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;في هذه الدعوى وإبداء ما يلزم من دفاع فيها بمعرفة الإدارة القانونية لديكم.</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-size:21px;font-family:\"Calibri\",sans-serif;'>مـــع أطيـــب التمنيـــات ،،،</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:center;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin: 0cm;font-size:16px;font-family: \"Times New Roman\", serif;text-align: right;'><strong><span style='font-size:27px;font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp;رئيس قطاع قضايا الإداري الكلي</span></strong><strong><span style='font-size:27px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:18px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:18px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:18px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-size:11px;font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>العضو المختص :&nbsp;</span></strong><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp;</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>المرفقات &nbsp;: صورة صحيفة الدعوى</span></strong></p>\r\n<p dir=\"RTL\" style='margin:0cm;font-size:16px;font-family:\"Times New Roman\",serif;text-align:justify;'><strong><span style='font-family:\"Calibri\",sans-serif;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></strong></p>";
                string htmlString = rawHtml;
                HtmlToPdf converter = new HtmlToPdf();
                MemoryStream stream = new MemoryStream();

                // set converter options
                converter.Options.PdfPageSize = PdfPageSize.A4;
                converter.Options.PdfPageOrientation = PdfPageOrientation.Portrait;
                converter.Options.WebPageWidth = 1024;
                converter.Options.WebPageHeight = 1024;
				converter.Options.EmbedFonts = true;
				Content = string.Concat($"<style>@font-face {{font-family: 'Sultan';src: url('{Directory.GetCurrentDirectory().Replace("\\", "/") + "/wwwroot/fonts/Sultan/arfonts-sultan-normal.ttf"}') format('truetype');font-weight: normal;font-style: normal;font-display: swap;}} @font-face {{font-family: 'Sultan Medium';src: url('{Directory.GetCurrentDirectory().Replace("\\", "/") + "/wwwroot/fonts/Sultan/arfonts-sultan-mudaim.ttf"}') format('truetype');font-weight: normal;font-style: normal;font-display: swap;}}</style>", Content);

				// create a new pdf document converting an url
				SelectPdf.PdfDocument pdfDocument = converter.ConvertHtmlString(Content);
                pdfDocument.Save(stream);
                pdfDocument.Close();
                stream.Close();
                FileData = stream.ToArray();
                string base64String = Convert.ToBase64String(FileData);
                DocumentPath = "data:application/pdf;base64," + base64String;
                DisplayDocumentViewer = true;
                StateHasChanged();
            }
            catch(Exception ex)
            {

            }
        }

    }
}
