@page "/add-borrow-literture"
@using FATWA_DOMAIN.Models
@using FATWA_DOMAIN.Models.CaseManagment
@using FATWA_DOMAIN.Models.ViewModel.CaseManagment
@using FATWA_DOMAIN.Models.ViewModel.Lms
@using FATWA_DOMAIN.Models.ViewModel.TaskVMs
@using Append.Blazor.Printing;
@using static FATWA_DOMAIN.Models.ViewModel.LiteratureAdvancedSearchVM
@inject IPrintingService PrintingService
@layout MainLayout


<RadzenContent Container="main">
    <ChildContent>

        @if (FromBarcode == true)
        {
            <div class="row pb-2">
                <div class="col-12 datagrid-rz-label">
                    <div class="row no-gutters">
                        <div class="col-6 detailSection">
                            <div class="detailHeading">
                                <h3>@translationState.Translate("Book_Name")</h3>
                            </div>
                            <div class="detailContent">

                                <h3>@borrowedLiteratureVM?.BookName</h3>
                            </div>
                        </div>
                        <div class="col-6 detailSection">
                            <div class="detailHeading">
                                <h3>@translationState.Translate("Author_Name")</h3>
                            </div>
                            <div class="detailContent">

                                <h3>@(Thread.CurrentThread.CurrentUICulture.Name == "en-US" ? borrowedLiteratureVM?.AuthorNameEn : borrowedLiteratureVM?.AuthorNameAr) </h3>
                            </div>
                        </div>
                        <div class="col-6 detailSection">
                            <div class="detailHeading">
                                <h3>@translationState.Translate("BarCode")</h3>
                            </div>
                            <div class="detailContent">

                                <h3>@borrowedLiteratureVM?.Barcode</h3>
                            </div>
                        </div>
                        <div class="col-6 detailSection">
                            <div class="detailHeading">
                                <h3>@translationState.Translate("ISBN_Number")</h3>
                            </div>
                            <div class="detailContent">

                                <h3>@borrowedLiteratureVM?.ISBN</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="row mt-3">
                <div class="col-md-12 popup-buttons-alignment">
                  
                    <RadzenButton Text="@translationState.Translate("Add_Literature")"
                                  ButtonStyle="ButtonStyle.Light"
                                  Click="@AddBorrowLiterature" />

                    <RadzenButton Text="@translationState.Translate("Cancel")"
                                  ButtonStyle="ButtonStyle.Light"
                                  Click="@Cancel" />





                </div>
            </div>

        }
        else
        {
            <div class="row col-md-12 pb-4">
                <div class="col-md-4 rz-calendar-webkit-fill">
                    <RadzenLabel Text="@translationState.Translate("Choose_Search_Item")" Style="display:block;" />
                    <RadzenDropDown TValue="AdvancedSearchDropDownEnum" Data="@AdvancedSearchOptions" AllowFiltering="true" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive" AllowClear="true"
                                    TextProperty="advancedSearchEnumName" ValueProperty="advancedSearchEnumValue" Placeholder="@translationState.Translate("Select_Option")"
                                    @bind-Value="@(advancedSearchVM.EnumSearchValue)" Change="OnChangeSearchValue" Style="display:block;">
                    </RadzenDropDown>
                </div>
                <div class="col-md-4 rz-calendar-webkit-fill">

                    @switch ((int)advancedSearchVM.EnumSearchValue)
                    {

                        case (int)AdvancedSearchDropDownEnum.Book_Name:
                            <RadzenLabel Text="@translationState.Translate("Book_Name")" Style="display:block;" Component="KeywordsType" />

                            <RadzenTextBox Disabled="false" MaxLength="100" style="display: block;" @bind-Value="@(advancedSearchVM.KeywordsType)" Placeholder="@translationState.Translate("Enter_Book_Name")" Name="KeywordsType" />
                            break;

                        case (int)AdvancedSearchDropDownEnum.Barcode:
                            <RadzenLabel Text="@translationState.Translate("Barcode")" Style="display:block;" Component="KeywordsType" />
                            <RadzenTextBox Disabled="false" MaxLength="100" style="display: block;" @bind-Value="@(advancedSearchVM.KeywordsType)" Placeholder="@translationState.Translate("Enter_Barcode")" Name="KeywordsType" />
                            break;

                        case (int)AdvancedSearchDropDownEnum.Sticker:
                            <RadzenLabel Text="@translationState.Translate("Sticker")" Style="display:block;" Component="KeywordsType" />
                            <RadzenTextBox Disabled="false" MaxLength="100" style="display: block;" @bind-Value="@(advancedSearchVM.KeywordsType)" Placeholder="@translationState.Translate("Enter_Sticker")" Name="KeywordsType" />
                            break;

                        case (int)AdvancedSearchDropDownEnum.Author_Name:
                            <RadzenLabel Text="@translationState.Translate("Author_Name")" Style="display:block;" Component="KeywordsType" />
                            <RadzenDropDown Data="LmsLiteratureAuthor"
                                            AllowFiltering="true"
                                            FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                            TextProperty=@(Thread.CurrentThread.CurrentUICulture.Name == "en-US" ? "FullName_En" : "FullName_En")
                                            ValueProperty="AuthorId"
                                            Style="display:block;"
                                            @bind-Value="@advancedSearchVM.GenericsIntergerKeyword"
                                            Placeholder="@translationState.Translate("Select")">
                            </RadzenDropDown>
                            break;

                        case (int)AdvancedSearchDropDownEnum.Book_Index:

                            <RadzenLabel Text="@translationState.Translate("Book_Index")" Style="display:block;" Component="KeywordsType" />

                            <RadzenDropDownDataGrid @bind-Value=@advancedSearchVM.GenericsIntergerKeyword
                                                    TValue="@(int)"
                                                    Data=@LiteratureIndexeDetails TextProperty=@(Thread.CurrentThread.CurrentCulture.Name == "en-US" ? "Name_En" : "Name_Ar")
                                                    ValueProperty="IndexId"
                                                    Style="width:100%;max-width:100%;"
                                                    AllowColumnResize="true"
                                                    AllowFilteringByAllStringColumns="true"
                                                    Name="DropDownDataGridColumns"
                                                    Placeholder="@translationState.Translate("Select")"
                                                    @onclick:stopPropagation="true">
                                <Columns>
                                    <RadzenDropDownDataGridColumn Property=@(Thread.CurrentThread.CurrentCulture.Name == "en-US" ? "Name_En" : "Name_Ar") Title=@translationState.Translate("Name") Width="90px" />
                                    <RadzenDropDownDataGridColumn Property="IndexNumber" Title="@translationState.Translate("Index_Number")" Width="90px" />
                                </Columns>
                            </RadzenDropDownDataGrid>
                            break;
                    }


                </div>

                <div class="col-md-4 d-flex align-items-center justify-content-start">
                    <div class="k-form-field-wrap" style="margin-top: 1.5rem;">
                        <RadzenButton Text="@translationState.Translate("Search")"
                                      ButtonStyle="ButtonStyle.Light"
                                      Click="@Search" />
                    </div>
                </div>
            </div>

            @if (AdvanceSearchGridSHow)
            {
                <div class="row mb-03">
                    <RadzenCard>
                        <div class="row tableContent table-responsive no-gutters pb-4">


                            <RadzenDataGrid @ref="grid0"
                                            FilterMode="Radzen.FilterMode.Advanced"
                                            Count="@(ListborrowedLiteratureVM != null ? ListborrowedLiteratureVM.Count() : 0)"
                                            AllowPaging="true"
                                            AllowSorting="true"
                                            AllowFiltering="false"
                                            Data="@ListborrowedLiteratureVM"
                                            TItem="BorrowedLiteratureVM"
                                            PageSize="@systemSettingState.Grid_Pagination"
                                            PagerHorizontalAlign="Radzen.HorizontalAlign.Center"
                                            PageSizeText="@translationState.Translate("Items_Per_Page")"
                                            PageSizeOptions="@systemSettingState.Page_Size_Options"
                                            EmptyText="@translationState.Translate("No_record_found")"
                                            PagingSummaryFormat="@(translationState.PageSummaryFormat != null ? translationState.PageSummaryFormat : "")"
                                            ShowPagingSummary="true" ColumnWidth="100px"
                                            AllowRowSelectOnRowClick="false"
                                            SelectionMode="DataGridSelectionMode.Multiple">
                                <Columns>

                                    <RadzenDataGridColumn TItem="BorrowedLiteratureVM" Title="@translationState.Translate("Action")" Width="70px" Filterable="false" Sortable="false" TextAlign="TextAlign.Center">
                                        <Template Context="rowItem">

                                            <RadzenButton ButtonStyle="ButtonStyle.Danger"
                                                          Class="addIcon"
                                                          Icon="add"
                                                          Title="@translationState.Translate("Add")"
                                                          Size="ButtonSize.Small"
                                                          Click="@((args) => AddBookFromGrid(rowItem))"
                                                          @onclick:stopPropagation="true" />

                                        </Template>
                                    </RadzenDataGridColumn>
                                    <RadzenDataGridColumn TItem="BorrowedLiteratureVM" Property="BookName" Title="@translationState.Translate("Book_Name")" />
                                    <RadzenDataGridColumn TItem="BorrowedLiteratureVM" Property=@(Thread.CurrentThread.CurrentUICulture.Name == "en-US" ? "AuthorNameEn" : "AuthorNameAr") Title="@translationState.Translate("Author")" />
                                    <RadzenDataGridColumn TItem="BorrowedLiteratureVM" Property="Barcode" Title="@translationState.Translate("Barcode_No")" />

                                </Columns>
                            </RadzenDataGrid>
                        </div>

                    </RadzenCard>

                </div>

            }


        }
    </ChildContent>
</RadzenContent>


