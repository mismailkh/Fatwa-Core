@page "/lmsliteratureborrowdetail-extension-approval-list"

@layout MainLayout
@using FATWA_DOMAIN.Models.ViewModel
@using static FATWA_DOMAIN.Enums.LiteratureEnum;

<PageTitle>@translationState.Translate("Literature_borrow_extension_approval")</PageTitle>

@if (loginState.ClaimList.Where(x => x.Value == "Permissions.LMS.LiteratureBorrowDetail.ExtensionApproval").Count() > 0)
{
	<RadzenContent Container="main">
		<ChildContent>
			<div class="row breadcrumbBar justify-content-center align-items-center pb-3">
				<div class="col-md-6">
					<RadzenBreadCrumb>
						<RadzenBreadCrumbItem Path="/Index" Text="@translationState.Translate("Home")" />
						<RadzenBreadCrumbItem Text="@translationState.Translate("Literature_borrow_extension_approval")" />
					</RadzenBreadCrumb>
				</div>
				<div class="col-md-6 d-flex justify-content-end">
					<div class="backtoDashboard">
						<RadzenButton ButtonStyle="ButtonStyle.Secondary"
								  Size="ButtonSize.Small"
								  title="@translationState.Translate("Go_Back_Dashboard")"
								  class="returnBtn" Icon="dashboard" Click="@GoBackDashboard" />

						<RadzenButton ButtonStyle="ButtonStyle.Secondary"
								  Size="ButtonSize.Small"
								  title="@translationState.Translate("Go_Back_HomeScreen")"
								  class="returnBtn"
								  Icon="home" Click="@GoBackHomeScreen" />
					</div>
				</div>
			</div>

			<div class="row TitleBar justify-content-center align-items-center py-4">
				<div class="col-md-6">
					<div class="row no-gutters">
						<RadzenHeading Size="H1" class="pageTitle" Text="@translationState.Translate("Literature_borrow_extension_approval")" />
					</div>
				</div>

                    <div class="col-md-6 d-flex justify-content-end">
                       
                    </div>
                 </div>
            <div class="row justify-content-center mainContentBlock py-4">
                <div class="col-md-12">
                    <div class="row no-gutters">
                        <div class="col-md-4 tableAdditionButton px-0 pb-3">
                            <RadzenTextBox Placeholder="@translationState.Translate("Grid_Search")"
                                       class="searchBox"
                                       Name="TextboxSearchGrid"
                            @oninput="@(async(args) => {search = $"{args.Value}";await grid.GoToPage(0);await OnSearchInput();})" />
                        </div>
                        <div class="col-md-8 d-flex justify-content-end tableAdditionButton px-0 pb-3">
                            
                        </div>
                    </div>
                    <div class="row tableContent table-responsive no-gutters pb-3">
                        <RadzenDataGrid @ref="grid"
                                    FilterMode="Radzen.FilterMode.Advanced"
                                    Count="@(getLiteratureBorrowExtensionApprovals != null ? getLiteratureBorrowExtensionApprovals.Count() : 0)"
                                    AllowPaging="true"
                                    AllowSorting="true"
                                    AllowFiltering="false"
                                    Data="@FilteredGetLiteratureBorrowExtensionApprovals"
                                    TItem="BorrowDetailVM"
                                    PageSize="@systemSettingState.Grid_Pagination"
                                    PagerHorizontalAlign="Radzen.HorizontalAlign.Center"
                                    PageSizeText="@translationState.Translate("Items_Per_Page")"
                                    PageSizeOptions="@systemSettingState.Page_Size_Options"
                                    EmptyText="@translationState.Translate("No_record_found")"
                                    PagingSummaryFormat="@(translationState.PageSummaryFormat != null ? translationState.PageSummaryFormat : "")"
                                    ShowPagingSummary="true">
                            <Columns>
                                <RadzenDataGridColumn TItem="BorrowDetailVM" TextAlign="TextAlign.Center" Title="@translationState.Translate("Action")" Width="140px" Filterable="false" Sortable="false">
                                    <Template Context="rowItem">
                                        @if(rowItem.ExtensionApprovalStatus == (int)BorrowApprovalStatus.PendingForExtensionApproval)
                                        {
                                            <RadzenButton ButtonStyle="ButtonStyle.Secondary"
                                                  class="editIcon"
                                                  Icon="mode"
                                                  Title="@translationState.Translate("Decision")"
                                                  Size="ButtonSize.Small"
                                                  Click="@((args) => DecisionExtension(rowItem))"
                                                  @onclick:stopPropagation="true" />
                                            <RadzenButton ButtonStyle="ButtonStyle.Secondary"
                                                  class="approvalIcon"
                                                  Icon="rule"
                                                  Title="@translationState.Translate("Approve/Reject")"
                                                  Size="ButtonSize.Small"
                                                  Click="@((args) => DecisionLmsLiteratureBorrowDetail(rowItem))"
                                                  @onclick:stopPropagation="true" />
                                        }
                                    </Template>
                                </RadzenDataGridColumn>
                                <RadzenDataGridColumn TItem="BorrowDetailVM" Property="LiteratureName" Title="@translationState.Translate("Book_Name")" />
                                <RadzenDataGridColumn TItem="BorrowDetailVM" Property="BarCodeNumber" Title="@translationState.Translate("Barcode_No")" />
                                    <RadzenDataGridColumn TItem="BorrowDetailVM" Property=@(Thread.CurrentThread.CurrentUICulture.Name == "en-US" ? "FullName_En" : "FullName_Ar") Title="@translationState.Translate("Borrower_Full_Name")" />
                                    <RadzenDataGridColumn TItem="BorrowDetailVM" Property=@(Thread.CurrentThread.CurrentUICulture.Name == "en-US" ? "BorrowApprovalStatus" : "BorrowApprovalStatusAr") Title="@translationState.Translate("Status")" />
@*                                    <RadzenDataGridColumn TItem="BorrowDetailVM" Property="TypeName_En" Title="@translationState.Translate("Type_Name")" /> 
*@
                                <RadzenDataGridColumn TItem="BorrowDetailVM" Property="IssueDate" Title="@translationState.Translate("Borrow_Issue_Date")" FormatString="{0:dd/MM/yyyy h:mm tt}" />
                                <RadzenDataGridColumn TItem="BorrowDetailVM" Property="ApprovalDate" Title="@translationState.Translate("Borrow_Approval_Date")" FormatString="{0:dd/MM/yyyy h:mm tt}" />
                                <RadzenDataGridColumn TItem="BorrowDetailVM" Property="Extended" Title="@translationState.Translate("extended")" />
                                <RadzenDataGridColumn TItem="BorrowDetailVM" Property="ExtendDueDate" Title="@translationState.Translate("Extend_Due_Date")" FormatString="{0:dd/MM/yyyy h:mm tt}" />
							</Columns>
						</RadzenDataGrid>


					</div>
				</div>
			</div>
		</ChildContent>
	</RadzenContent>
}
else
{
	<div class="demo-alert demo-alert-error" role="alert">@translationState.Translate("Unauthorized")</div>
} 