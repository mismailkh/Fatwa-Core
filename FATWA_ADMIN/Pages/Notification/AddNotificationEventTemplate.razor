@page "/add-event-template/{EventId}/{ChannelId}"
@page "/add-event-template/{Id}"
@layout MainLayout
@using FATWA_DOMAIN.Models.AdminModels.UserManagement
@using FATWA_DOMAIN.Models.Notifications;
@using static FATWA_GENERAL.Helper.Enum;

<PageTitle>@translationState.Translate("Event")</PageTitle>
<div class="row breadcrumbBar justify-content-center align-items-center pb-3">
    <div class="col-md-6">
        <div class="row no-gutters">
            <RadzenBreadCrumb>
                <RadzenBreadCrumbItem Path="/Index" Text="@translationState.Translate("Home")" />
                <RadzenBreadCrumbItem Path="/notification-eventlist" Text="@translationState.Translate("Event_List")" />
                <RadzenBreadCrumbItem Text="@(Id == null ? translationState.Translate("Create_Notification_Event_Template") : translationState.Translate("Update_Notification_Event_Template"))" />
            </RadzenBreadCrumb>
        </div>
    </div>
    <div class="col-md-6 d-flex justify-content-end">
        <div class="backtoDashboard">
            <RadzenButton ButtonStyle="ButtonStyle.Secondary"
                          Size="ButtonSize.Small"
                          title="@translationState.Translate("Go_Back_HomeScreen")"
                          class="returnBtn"
                          Icon="home" Click="@GoBackHomeScreen" />
        </div>
    </div>
</div>
<div class="row TitleBar justify-content-left align-items-center py-4 pt-5">
    <div class="col-md-6">
        <div class="row no-gutters">
            <RadzenHeading Size="H1" Text="@translationState.Translate("Create_Notification_Event_Template")" />
        </div>
    </div>
    <div class="col-md-6 d-flex justify-content-end ">
    </div>
</div>

<RadzenContent Container="main">
    <ChildContent>
        <RadzenTemplateForm Data="@Template" Visible="@(Template != null)" TItem="NotificationTemplate" Submit="@SaveChanges" Style="display:contents">
            <ChildContent>
                <RadzenCard>
                    <div class="col-12 mt-3">
                        <div class="row">
                            <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 form-group">
                                <div class="k-form-field">
                                    <div class="k-form-field-wrap">
                                        <label for="ccs" class="k-label k-form-label">@translationState.Translate("Event")</label>
                                        <div class="k-form-field-wrap">
                                            <RadzenDropDown Data="@Events"
                                                            TextProperty=@(Thread.CurrentThread.CurrentCulture.Name == "en-US" ? "NameEn" : "NameAr")
                                                            Disabled="true"
                                                            ValueProperty="EventId"
                                                            Placeholder="@translationState.Translate("Select")"
                                                            Change="@OnEventsChange"
                                                            Style="display:block;"
                                                            @bind-Value="Template.EventId" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 form-group">
                                <div class="k-form-field">
                                    <div class="k-form-field-wrap">
                                        <label for="ccs" class="k-label k-form-label">@translationState.Translate("Channel")</label>
                                        <div class="k-form-field-wrap">
                                            <RadzenDropDown Data="@Channels"
                                                            Disabled="true"
                                                            TextProperty=@(Thread.CurrentThread.CurrentCulture.Name == "en-US" ? "NameEn" : "NameAr")
                                                            ValueProperty="ChannelId"
                                                            Placeholder="@translationState.Translate("Select")"
                                                            Style="display:block;"
                                                            @bind-Value="Template.ChannelId" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 form-group">
                                <div class="k-form-field">
                                    <div class="k-form-field-wrap">
                                        <label for="ccs" class="k-label k-form-label">@translationState.Translate("Name_En")</label>
                                        <div class="k-form-field-wrap">
                                            <RadzenTextBox Placeholder="@translationState.Translate("Name_En")" Name="NameEn" @bind-Value="@Template.NameEn"></RadzenTextBox>
                                            <RadzenRequiredValidator Component="NameEn" Text="@translationState.Translate("Required_Field")" />
                                            <RadzenLengthValidator Component="NameEn" Max="90" Text="@translationState.Translate("Max_Ninety_Characters")" />
                                            <RadzenRegexValidator Component="NameEn" Text="@translationState.Translate("Cannot_Have_Trailing_Spaces")" Pattern="@RegexPatterns.EnglishPattern" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 form-group">
                                <div class="k-form-field">
                                    <div class="k-form-field-wrap">
                                        <label for="ccs" class="k-label k-form-label">@translationState.Translate("Name_Ar")</label>
                                        <div class="k-form-field-wrap">
                                            <RadzenTextBox Placeholder="@translationState.Translate("Name_Ar")" Name="NameAr" @bind-Value="@Template.NameAr"></RadzenTextBox>
                                            <RadzenRequiredValidator Component="NameAr" Text="@translationState.Translate("Required_Field")" />
                                            <RadzenLengthValidator Component="NameAr" Max="90" Text="@translationState.Translate("Max_Ninety_Characters")" />
                                            <RadzenRegexValidator Component="NameAr" Text="@translationState.Translate("Cannot_Have_Trailing_Spaces")" Pattern="@RegexPatterns.ArabicPattern" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @if (Template.ChannelId == (int)NotificationChannelEnum.Email)
                        {
                            <div class="row">
                                <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 form-group">
                                    <div class="k-form-field">
                                        <div class="k-form-field-wrap">
                                            <label for="ccs" class="k-label k-form-label">@translationState.Translate("Subject_En")</label>
                                            <div class="k-form-field-wrap">
                                                <RadzenTextBox Placeholder="@translationState.Translate("Subject_En")" Name="SubjectEn" @bind-Value="@Template.SubjectEn"></RadzenTextBox>
                                                <RadzenRequiredValidator Component="SubjectEn" Text="@translationState.Translate("Required_Field")" />
                                                <RadzenLengthValidator Component="SubjectEn" Max="90" Text="@translationState.Translate("Max_Ninety_Characters")" />
                                                <RadzenRegexValidator Component="SubjectEn" Text="@translationState.Translate("Cannot_Have_Trailing_Spaces")" Pattern="@RegexPatterns.EnglishPattern" />

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 form-group">
                                    <div class="k-form-field">
                                        <div class="k-form-field-wrap">
                                            <label for="ccs" class="k-label k-form-label">@translationState.Translate("Subject_Ar")</label>
                                            <div class="k-form-field-wrap">
                                                <RadzenTextBox Placeholder="@translationState.Translate("Subject_Ar")" Name="SubjectAr" @bind-Value="@Template.SubjectAr"></RadzenTextBox>
                                                <RadzenRequiredValidator Component="SubjectAr" Text="@translationState.Translate("Required_Field")" />
                                                <RadzenLengthValidator Component="SubjectAr" Max="90" Text="@translationState.Translate("Max_Ninety_Characters")" />
                                                <RadzenRegexValidator Component="SubjectAr" Text="@translationState.Translate("Cannot_Have_Trailing_Spaces")" Pattern="@RegexPatterns.ArabicPattern" />

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        }
                        <div class="row">
                            <div class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4 form-group">
                                <div class="k-form-field">
                                    <div class="k-form-field-wrap">
                                        <label for="ccs" class="k-label k-form-label">@translationState.Translate("Body_En")</label>
                                        <div class="k-form-field-wrap">
                                            <RadzenTextArea Class="telerik-textarea-height-600" Name="BodyEn" Placeholder="@translationState.Translate("Body_En")" @bind-Value="@Template.BodyEn"></RadzenTextArea>
                                            <RadzenRequiredValidator Component="BodyEn" Text="@translationState.Translate("Required_Field")" />
                                            <RadzenLengthValidator Component="BodyEn" Max="500" Text="@translationState.Translate("Max_Five_Hundred_Characters")" />
                                            <RadzenRegexValidator Component="BodyEn" Text="@translationState.Translate("Cannot_Have_Trailing_Spaces")" Pattern="@RegexPatterns.NoSpacesTextAreaPattern" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4 form-group">
                                <div class="k-form-field">
                                    <div class="k-form-field-wrap">
                                        <label for="ccs" class="k-label k-form-label">@translationState.Translate("Body_Ar")</label>
                                        <div class="k-form-field-wrap">
                                            <RadzenTextArea Class="telerik-textarea-height-600" Placeholder="@translationState.Translate("Body_Ar")" Name="BodyAr" @bind-Value="@Template.BodyAr"></RadzenTextArea>
                                            <RadzenRequiredValidator Component="BodyAr" Text="@translationState.Translate("Required_Field")" />
                                            <RadzenLengthValidator Component="BodyAr" Max="500" Text="@translationState.Translate("Max_Five_Hundred_Characters")" />
                                            <RadzenRegexValidator Component="BodyAr" Text="@translationState.Translate("Cannot_Have_Trailing_Spaces")" Pattern="@RegexPatterns.NoSpacesTextAreaPattern" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @if (Template.EventId != 0)
                            {
                                <div class="col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 form-group">
                                    <div class="col-12">
                                        <RadzenLabel />
                                        <RadzenDataGrid EmptyText="@translationState.Translate("No_record_found")"
                                                        @ref="PlaceHolderGrid"
                                                        FilterMode="Radzen.FilterMode.Advanced"
                                                        AllowPaging="true"
                                                        AllowSorting="true"
                                                        Data="@PlaceHolder"
                                                        TItem="NotificationEventPlaceholders"
                                                        PageSize="@loginState.PageSize"
                                                        PagerHorizontalAlign="Radzen.HorizontalAlign.Center">

                                            <Columns>

                                                <RadzenDataGridColumn TItem="NotificationEventPlaceholders" Property=PlaceHolderName Title="@translationState.Translate("Name")" />
                                            </Columns>
                                        </RadzenDataGrid>
                                    </div>
                                </div>
                            }
                        </div>
                        <div class="popup-buttons-alignment mb-3">
                            <RadzenButton ButtonType="Radzen.ButtonType.Submit"
                                          Style="margin-left: 10px; margin-right: 10px;"
                                          ButtonStyle="ButtonStyle.Primary" Text="@(Id == null ? translationState.Translate("Create") : translationState.Translate("Update"))" />
                            <RadzenButton Text="@translationState.Translate("Cancel")"
                                          ButtonStyle="ButtonStyle.Light"
                                          Click="@CancelChanges" />
                        </div>
                    </div>
                </RadzenCard>
            </ChildContent>
        </RadzenTemplateForm>
    </ChildContent>
</RadzenContent>